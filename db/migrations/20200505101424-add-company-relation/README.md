# Migration `20200505101424-add-company-relation`

This migration has been generated by Abu Uzayr at 5/5/2020, 10:14:24 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Company" (
    "gdRating" text   ,
    "gdUrl" text   ,
    "id" SERIAL,
    "liEmpCount" integer   ,
    "liUrl" text   ,
    "name" text  NOT NULL ,
    PRIMARY KEY ("id")
)

ALTER TABLE "public"."Job" DROP COLUMN "company",
ADD COLUMN "companyId" integer  NOT NULL ,
ADD COLUMN "type" text  NOT NULL DEFAULT 'aggregated',
ALTER COLUMN "description" DROP NOT NULL;

ALTER TABLE "public"."Job" ADD FOREIGN KEY ("companyId")REFERENCES "public"."Company"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200504181510-add-description..20200505101424-add-company-relation
--- datamodel.dml
+++ datamodel.dml
@@ -2,9 +2,9 @@
 // learn more about it in the docs: https://pris.ly/d/prisma-schema
 datasource postgresql {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 generator client {
   provider = "prisma-client-js"
@@ -15,18 +15,30 @@
 model Job {
   id          Int      @default(autoincrement()) @id
   name        String
-  company     String
+  company     Company  @relation(fields: [companyId], references: [id])
+  companyId   Int
   avatar      String?
   url         String?
   salary      String?
   postedDate  DateTime @default(now())
-  description String
+  description String?
+  type        String   @default("aggregated")
   tags        Tag[]    @relation(references: [id])
 }
 model Tag {
   id        Int      @default(autoincrement()) @id
   name      String
   jobs      Job[]    @relation(references: [id])
+}
+
+model Company {
+  id         Int      @default(autoincrement()) @id
+  name       String
+  gdUrl      String?
+  gdRating   String?
+  liUrl      String?
+  liEmpCount Int?
+  jobs       Job[]
 }
```
